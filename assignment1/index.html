<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Assignment 1 (2/21/2019)</title>
    
    <link rel="stylesheet" href="../classes/jquery-ui-1.12.1/jquery-ui.css" type="text/css" media="all" />
    <script type="text/javascript" src="../classes/jquery-ui-1.12.1/external/jquery/jquery.js" ></script>
    <script type="text/javascript" src="../classes/jquery-ui-1.12.1/jquery-ui.js"></script>
    
    <link rel="stylesheet" href="../classes/noUiSlider-13.1.1/distribute/nouislider.min.css" type="text/css" />
    <script type="text/javascript" src="../classes/noUiSlider-13.1.1/distribute/nouislider.min.js"></script>
    
    <link rel="stylesheet" href="../classes/ON-OFF-Toggle-Switches-Switcher/css/switcher.css" type="text/css" />
    <script type="text/javascript" src="../classes/ON-OFF-Toggle-Switches-Switcher/js/jquery.switcher.js"></script>
    
    <script type="text/javascript" src="https://momentjs.com/downloads/moment.js"></script>
    
    <script type="text/javascript" src="custom.js"></script>
    
    <link rel="stylesheet" href="style.css" type="text/css" />
</head>
<body>
    
    <nav style="font-family: 'Segoe UI',Arial,sans-serif;">
        <a href="..">Home</a>&nbsp;&nbsp;
        <a href="../ex1/">Exercise 1</a>&nbsp;&nbsp;
        <a href="../ex2/">Exercise 2</a>&nbsp;&nbsp;
        <a href="../ex3/">Exercise 3</a>&nbsp;&nbsp;
        <a href="../ex4/">Exercise 4</a>
    </nav>
    
    <h1 style="font-family: 'Segoe UI',Arial,sans-serif;">Assignment 1: Javascript Skills</h1>
    
    <div id="containerX" style="text-align:center;margin-left:5%;margin-right:5%;width:90%;border-style:solid;border-width:thin">
        <div style="width:87px;margin:5px;margin-top: -15.5px">
            <div style="background-color:white;padding:5px;">Duration X:</div>
        </div>
        <div style="margin:10px">Select subdivisions:</div>
        <div id="range" style="margin:50px;margin-bottom:25px" class="noUi-target noUi-ltr noUi-horizontal"></div>
        <div id="inputsX" style="display:inline-block;text-align:left;margin:10px;height:45px">
            <div id="yrX" class="sub_cont">
                <div id="yrXlabel" style="width:79px;text-align:center">
                    Years:
                </div>
                <input id="yrXin" style="width:75px" type="number" min="0" value="0"/>
            </div>
            <div id="moX" class="sub_cont">
                <div id="moXlabel" style="width:79px;text-align:center">
                    Months:
                </div>
                <input id="moXin" style="width:75px" type="number" min="0" value="0"/>
            </div>
            <div id="wwX" class="sub_cont">
                <div id="wwXlabel" style="width:79px;text-align:center">
                    Weeks:
                </div>
                <input id="wwXin" style="width:75px" type="number" min="0" value="0"/>
            </div>
            <div id="ddX" class="sub_cont">
                <div id="ddXlabel" style="width:79px;text-align:center">
                    Days:
                </div>
                <input id="ddXin" style="width:75px" type="number" min="0" value="0"/>
            </div>
            <div id="hrX" class="sub_cont">
                <div id="hrXlabel" style="width:79px;text-align:center">
                    Hours:
                </div>
                <input id="hrXin" style="width:75px" type="number" min="0" value="0"/>
            </div>
            <div id="mmX" class="sub_cont">
                <div id="mmXlabel" style="width:79px;text-align:center">
                    Minutes:
                </div>
                <input id="mmXin" style="width:75px" type="number" min="0" value="0"/>
            </div>
            <div id="ssX" class="sub_cont">
                <div id="ssXlabel" style="width:79px;text-align:center">
                    Seconds:
                </div>
                <input id="ssXin" style="width:75px" type="number" min="0" value="0"/>
            </div>
            <div id="msX" class="sub_cont">
                <div id="msXlabel" style="width:79px;text-align:center">
                    Millisecs:
                </div>
                <input id="msXin" style="width:75px" type="number" min="0" value="0"/>
            </div>
        </div>
        <div id="resetX" style="margin-right:10px;margin-bottom:10px;text-align:right"><button>Reset X</button></div>
    </div>
    
    <div style="text-align:center;margin:10px">
        <div style="display:inline-block;text-align:left;" class="form-check form-check-inline">
            <input id="plusOrMinus" class="form-check-input" type="checkbox" id="inlineCheckbox1" value="plus">
        </div>
    </div>
    
    <div id="containerY" style="text-align:center;margin-left:5%;margin-right:5%;width:90%;border-style:solid;border-width:thin">
        <div style="width:87px;margin:5px;margin-top: -15.5px">
            <div style="background-color:white;padding:5px;">Duration Y:</div>
        </div>
        <div style="margin:10px">Select subdivisions:</div>
        <div id="rangeY" style="margin:50px;margin-bottom:25px" class="noUi-target noUi-ltr noUi-horizontal"></div>
        <div id="inputsY" style="display:inline-block;text-align:left;margin:10px;height:45px">
            <div id="yrY" class="sub_cont">
                <div id="yrYlabel" style="width:79px;text-align:center">
                    Years:
                </div>
                <input id="yrYin" style="width:75px" type="number" min="0" value="0"/>
            </div>
            <div id="moY" class="sub_cont">
                <div id="moYlabel" style="width:79px;text-align:center">
                    Months:
                </div>
                <input id="moYin" style="width:75px" type="number" min="0" value="0"/>
            </div>
            <div id="wwY" class="sub_cont">
                <div id="wwYlabel" style="width:79px;text-align:center">
                    Weeks:
                </div>
                <input id="wwYin" style="width:75px" type="number" min="0" value="0"/>
            </div>
            <div id="ddY" class="sub_cont">
                <div id="ddXlabel" style="width:79px;text-align:center">
                    Days:
                </div>
                <input id="ddYin" style="width:75px" type="number" min="0" value="0"/>
            </div>
            <div id="hrY" class="sub_cont">
                <div id="hrYlabel" style="width:79px;text-align:center">
                    Hours:
                </div>
                <input id="hrYin" style="width:75px" type="number" min="0" value="0"/>
            </div>
            <div id="mmY" class="sub_cont">
                <div id="mmYlabel" style="width:79px;text-align:center">
                    Minutes:
                </div>
                <input id="mmYin" style="width:75px" type="number" min="0" value="0"/>
            </div>
            <div id="ssY" class="sub_cont">
                <div id="ssYlabel" style="width:79px;text-align:center">
                    Seconds:
                </div>
                <input id="ssYin" style="width:75px" type="number" min="0" value="0"/>
            </div>
            <div id="msY" class="sub_cont">
                <div id="msYlabel" style="width:79px;text-align:center">
                    Millisecs:
                </div>
                <input id="msYin" style="width:75px" type="number" min="0" value="0"/>
            </div>
        </div>
        <div id="resetY" style="margin-right:10px;margin-bottom:10px;text-align:right"><button>Reset Y</button></div>
    </div>
    
    <div style="text-align:center">
        <button id="calcButton" style="margin:20px">Calculate</button>
    </div>
    
    <div style="text-align:center;margin-left:5%;margin-right:5%;width:90%;border-style:solid;border-width:thin">
        <div style="width:62px;margin:5px;margin-top: -15.5px">
            <div style="background-color:white;padding:5px;">Results:</div>
        </div>
        <div id="results"></div>
    </div>
    
    <script>
        $( document ).ready(function() {
            minMaxX = [3,4];
            minMaxY = minMaxX.slice(0);
            $.switcher();
            switch_ = $("#plusOrMinus");

            var arrLabels = ["Years", "Months", "Weeks", "Days", "Hours", "Minutes", "Seconds", "Millisecs"];
            
            var trueLabels = ["y", "M", "w", "d", "h", "m", "s", "ms"];
            
            var arrIDsX = ["yrX", "moX", "wwX", "ddX", "hrX", "mmX", "ssX", "msX"];
            
            var arrIDsY = ["yrY", "moY", "wwY", "ddY", "hrY", "mmY", "ssY", "msY"];
            
            var range = document.getElementById('range');
            var slider = noUiSlider.create(range, {
                range: {
                    'min': 0,
                    'max': 7
                },
                step: 1,
                start: [minMaxX[0], minMaxX[1]],
                connect: true,
                direction: 'ltr',
                orientation: 'horizontal',
                behaviour: 'tap-drag',
                tooltips: true,
                format: {
                    to: function (value) {
                        return arrLabels[value];
                    },
                    from: function (value) {
                        return value;
                    }
                }
            });
            
            function inputs2display(range) {
                for (i=0; i<arrIDsX.length; i++) {
                    if (i<range[0] || i>range[1]) {
                        $("#"+arrIDsX[i]).hide();
                    } else {
                        $("#"+arrIDsX[i]).show();
                    }
                }
            }
            
            range.noUiSlider.on('update', function(values, handle, unencoded) {
                minMaxX = unencoded;
                inputs2display(unencoded);
            });
            
            var rangeY = document.getElementById('rangeY');
            var sliderY = noUiSlider.create(rangeY, {
                range: {
                    'min': 0,
                    'max': 7
                },
                step: 1,
                start: [minMaxY[0], minMaxY[1]],
                connect: true,
                direction: 'ltr',
                orientation: 'horizontal',
                behaviour: 'tap-drag',
                tooltips: true,
                format: {
                    to: function (value) {
                        return arrLabels[value];
                    },
                    from: function (value) {
                        return value;
                    }
                }
            });
            
            function inputs2displayY(range) {
                for (i=0; i<arrIDsY.length; i++) {
                    if (i<range[0] || i>range[1]) {
                        $("#"+arrIDsY[i]).hide();
                    } else {
                        $("#"+arrIDsY[i]).show();
                    }
                }
            }
            
            rangeY.noUiSlider.on('update', function(values, handle, unencoded) {
                minMaxY = unencoded;
                inputs2displayY(unencoded);
            });
            
            function duration2string(dur) {
                var toRemove = 0;
                str2return = "{";
                if (parseInt(dur.get('years')) > 0) {
                    str2return = str2return + dur.get('years') + ' y, ';
                    toRemove = 2;
                }
                if (parseInt(dur.get('months')) > 0) {
                    str2return = str2return + dur.get('months') + ' M, ';
                    toRemove = 2;
                }
                if (parseInt(dur.get('weeks')) > 0) {
                    str2return = str2return + dur.get('weeks') + ' w, ';
                    toRemove = 2;
                }
                if (parseInt(dur.get('days')) > 0) {
                    str2return = str2return + dur.get('days') + ' d, ';
                    toRemove = 2;
                }
                if (parseInt(dur.get('hours')) > 0) {
                    str2return = str2return + dur.get('hours') + ' h, ';
                    toRemove = 2;
                }
                if (parseInt(dur.get('minutes')) > 0) {
                    str2return = str2return + dur.get('minutes') + ' m, ';
                    toRemove = 2;
                }
                if (parseInt(dur.get('seconds')) > 0) {
                    str2return = str2return + dur.get('seconds') + ' s, ';
                    toRemove = 2;
                }
                if (parseInt(dur.get('milliseconds')) > 0) {
                    str2return = str2return + dur.get('milliseconds') + ' ms, ';
                    toRemove = 2;
                }
                str2return = str2return.substring(0, str2return.length - toRemove) + "}";
                if (toRemove>0) {
                    return str2return;
                } else return "{0}";
                
            }
            
            // true: minus; false: plus
            var plusMinusToggle = document.getElementById("plusOrMinus");
            var calcButton = document.getElementById("calcButton");
            calcButton.onclick = function(){
                var sumX = moment.duration(0);
                for (i=0; i<arrIDsX.length; i++) {
                    elmt = document.getElementById(arrIDsX[i]+"in");
                    if (!(i<minMaxX[0] || i>minMaxX[1])) {
                        sumX.add(parseInt(elmt.value), trueLabels[i]);
                    }
                }
                var sumY = moment.duration(0);
                for (i=0; i<arrIDsY.length; i++) {
                    elmt = document.getElementById(arrIDsY[i]+"in");
                    if (!(i<minMaxY[0] || i>minMaxY[1])) {
                        sumY.add(parseInt(elmt.value), trueLabels[i]);
                    }
                }
                if (plusMinusToggle.checked) {
                    // subtract:
                    // If Y is greater than X, give message:
                    if (sumY.asMilliseconds() > sumX.asMilliseconds()) {
                        document.getElementById("results").innerHTML = "<div style='margin-bottom:10px;color:red'>Please enter a duration Y that is less than or equal to duration X.</div>";
                    } else {
                        var tempX = duration2string(sumX);
                        var result = sumX.subtract(sumY);
                        document.getElementById("results").innerHTML = "<div style='margin-bottom:10px;color:green'>" + tempX + " - " + duration2string(sumY) + " = " + duration2string(result) + "</div>";
                    }
                } else {
                    // add:
                    var tempX = duration2string(sumX);
                    var result = sumX.add(sumY);
                    document.getElementById("results").innerHTML = "<div style='margin-bottom:10px;color:green'>" + tempX + " + " + duration2string(sumY) + " = " + duration2string(result) + "</div>";
                }
            };
            
            var resetXbutton = document.getElementById("resetX");
            var resetYbutton = document.getElementById("resetY");
            resetXbutton.onclick = function(){
                for (var i=0; i<arrIDsX.length; i++) {
                    document.getElementById(arrIDsX[i]+"in").value = 0;
                }
            }
            resetYbutton.onclick = function(){
                for (var i=0; i<arrIDsY.length; i++) {
                    console.log(arrIDsY[i]+"in");
                    document.getElementById(arrIDsY[i]+"in").value = 0;
                }
            }
            
        });
    </script>

</body>
</html>
